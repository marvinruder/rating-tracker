FROM node:19.9.0-alpine as yarn
ENV FORCE_COLOR true

WORKDIR /workdir

COPY . .
RUN --mount=type=cache,target=/tmp/global,id=rating-tracker-yarn-global \
  yarn --immutable && \
  yarn workspace rating-tracker-backend test:prisma:migrate:init

ENTRYPOINT [ "/bin/sh" ]
